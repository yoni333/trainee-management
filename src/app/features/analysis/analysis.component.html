<div class="analysis-container">
  
  <!-- Filters Section -->
  <app-analysis-filters></app-analysis-filters>

  <!-- Loading Indicator -->
  <div *ngIf="loading$ | async" class="loading-section">
    <mat-card>
      <mat-card-content class="loading-content">
        <div class="loading-spinner">
          <mat-icon>analytics</mat-icon>
          <p>Loading analysis data...</p>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Charts Section -->
  <div *ngIf="!(loading$ | async)" class="charts-section">
    
    <!-- Main Charts Area -->
    <div class="main-charts" 
         cdkDropListGroup>
      
      <!-- Left Chart (Position 0) -->
      <div class="chart-panel left-chart">
        <app-chart-container
          [position]="0"
          [chartPosition]="(leftChart$ | async)|| undefined"
          [trainees]="(filteredTrainees$ | async) || []"
          (chartSwapped)="onChartSwapped($event)">
        </app-chart-container>
      </div>

      <!-- Right Chart (Position 1) -->
      <div class="chart-panel right-chart">
        <app-chart-container
          [position]="1"
          [chartPosition]="(rightChart$ | async)||undefined"
          [trainees]="(filteredTrainees$ | async)||[]"
          (chartSwapped)="onChartSwapped($event)">
        </app-chart-container>
      </div>
      
    </div>

    <!-- Hidden Chart Button (Position 2) -->
    <div class="hidden-chart-section">
      <app-chart-container
        [position]="2"
        [chartPosition]="(hiddenChart$ | async) || undefined"
        [trainees]="(filteredTrainees$ | async) || []"
        (chartSwapped)="onChartSwapped($event)">
      </app-chart-container>
    </div>
    
  </div>

</div>
